\hypertarget{group__pf__cofold}{\section{Partition Function for two hybridized Sequences}
\label{group__pf__cofold}\index{Partition Function for two hybridized Sequences@{Partition Function for two hybridized Sequences}}
}


Partition Function Cofolding.  


Collaboration diagram for Partition Function for two hybridized Sequences\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=338pt]{group__pf__cofold}
\end{center}
\end{figure}
\subsection*{Files}
\begin{DoxyCompactItemize}
\item 
file \hyperlink{part__func__co_8h}{part\+\_\+func\+\_\+co.\+h}
\begin{DoxyCompactList}\small\item\em Partition function for two R\+N\+A sequences. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{group__pf__cofold_structvrna__dimer__pf__s}{vrna\+\_\+dimer\+\_\+pf\+\_\+s}
\item 
struct \hyperlink{group__pf__cofold_structvrna__dimer__conc__s}{vrna\+\_\+dimer\+\_\+conc\+\_\+s}
\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
\hypertarget{group__pf__cofold_ga444df1587c9a2ca15b8eb25188f629c3}{typedef struct \hyperlink{group__pf__cofold_structvrna__dimer__pf__s}{vrna\+\_\+dimer\+\_\+pf\+\_\+s} \hyperlink{group__pf__cofold_ga444df1587c9a2ca15b8eb25188f629c3}{vrna\+\_\+dimer\+\_\+pf\+\_\+t}}\label{group__pf__cofold_ga444df1587c9a2ca15b8eb25188f629c3}

\begin{DoxyCompactList}\small\item\em Typename for the data structure that stores the dimer partition functions, \hyperlink{group__pf__cofold_structvrna__dimer__pf__s}{vrna\+\_\+dimer\+\_\+pf\+\_\+s}, as returned by \hyperlink{group__pf__cofold_ga4e5c7d06c302a7c59fc0d64dc142ca63}{vrna\+\_\+pf\+\_\+dimer()} \end{DoxyCompactList}\item 
\hypertarget{group__pf__cofold_gac48c2723444ecfdceafcfd525ca98322}{typedef struct \hyperlink{group__pf__cofold_structvrna__dimer__conc__s}{vrna\+\_\+dimer\+\_\+conc\+\_\+s} \hyperlink{group__pf__cofold_gac48c2723444ecfdceafcfd525ca98322}{vrna\+\_\+dimer\+\_\+conc\+\_\+t}}\label{group__pf__cofold_gac48c2723444ecfdceafcfd525ca98322}

\begin{DoxyCompactList}\small\item\em Typename for the data structure that stores the dimer concentrations, \hyperlink{group__pf__cofold_structvrna__dimer__conc__s}{vrna\+\_\+dimer\+\_\+conc\+\_\+s}, as required by vrna\+\_\+pf\+\_\+dimer\+\_\+concentration() \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{group__pf__cofold_ga444df1587c9a2ca15b8eb25188f629c3}{vrna\+\_\+dimer\+\_\+pf\+\_\+t} \hyperlink{group__pf__cofold_ga4e5c7d06c302a7c59fc0d64dc142ca63}{vrna\+\_\+pf\+\_\+dimer} (\hyperlink{group__fold__compound_ga1b0cef17fd40466cef5968eaeeff6166}{vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$vc, char $\ast$structure)
\begin{DoxyCompactList}\small\item\em Calculate partition function and base pair probabilities of nucleic acid/nucleic acid dimers. \end{DoxyCompactList}\item 
void \hyperlink{group__pf__cofold_gaf04708a63d2385d5959db9f886741479}{vrna\+\_\+pf\+\_\+dimer\+\_\+probs} (double F\+A\+B, double F\+A, double F\+B, \hyperlink{group__data__structures_ga8e4eb5e1bfc95776559575beb359af87}{vrna\+\_\+plist\+\_\+t} $\ast$pr\+A\+B, const \hyperlink{group__data__structures_ga8e4eb5e1bfc95776559575beb359af87}{vrna\+\_\+plist\+\_\+t} $\ast$pr\+A, const \hyperlink{group__data__structures_ga8e4eb5e1bfc95776559575beb359af87}{vrna\+\_\+plist\+\_\+t} $\ast$pr\+B, int Alength, const \hyperlink{group__energy__parameters_ga01d8b92fe734df8d79a6169482c7d8d8}{vrna\+\_\+exp\+\_\+param\+\_\+t} $\ast$exp\+\_\+params)
\begin{DoxyCompactList}\small\item\em Compute Boltzmann probabilities of dimerization without homodimers. \end{DoxyCompactList}\item 
\hyperlink{group__pf__cofold_gac48c2723444ecfdceafcfd525ca98322}{vrna\+\_\+dimer\+\_\+conc\+\_\+t} $\ast$ \hyperlink{group__pf__cofold_ga83b8d5d0f7875d6d5013b208f23e3356}{vrna\+\_\+pf\+\_\+dimer\+\_\+concentrations} (double Fc\+A\+B, double Fc\+A\+A, double Fc\+B\+B, double F\+E\+A, double F\+E\+B, const double $\ast$startconc, const \hyperlink{group__energy__parameters_ga01d8b92fe734df8d79a6169482c7d8d8}{vrna\+\_\+exp\+\_\+param\+\_\+t} $\ast$exp\+\_\+params)
\begin{DoxyCompactList}\small\item\em Given two start monomer concentrations a and b, compute the concentrations in thermodynamic equilibrium of all dimers and the monomers. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hypertarget{group__pf__cofold_gaff27888c4088cc1f60fd59cbd589474c}{int \hyperlink{group__pf__cofold_gaff27888c4088cc1f60fd59cbd589474c}{mirnatog}}\label{group__pf__cofold_gaff27888c4088cc1f60fd59cbd589474c}

\begin{DoxyCompactList}\small\item\em Toggles no intrabp in 2nd mol. \end{DoxyCompactList}\item 
\hypertarget{group__pf__cofold_gac2d1851a710a8561390861155ca988fe}{double \hyperlink{group__pf__cofold_gac2d1851a710a8561390861155ca988fe}{F\+\_\+monomer} \mbox{[}2\mbox{]}}\label{group__pf__cofold_gac2d1851a710a8561390861155ca988fe}

\begin{DoxyCompactList}\small\item\em Free energies of the two monomers. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Partition Function Cofolding. 

To simplify the implementation the partition function computation is done internally in a null model that does not include the duplex initiation energy, i.\+e. the entropic penalty for producing a dimer from two monomers). The resulting free energies and pair probabilities are initially relative to that null model. In a second step the free energies can be corrected to include the dimerization penalty, and the pair probabilities can be divided into the conditional pair probabilities given that a re dimer is formed or not formed. See \cite{bernhart:2006} for further details. 

\subsection{Data Structure Documentation}
\index{vrna\+\_\+dimer\+\_\+pf\+\_\+s@{vrna\+\_\+dimer\+\_\+pf\+\_\+s}}\label{structvrna__dimer__pf__s}
\hypertarget{group__pf__cofold_structvrna__dimer__pf__s}{}
\subsubsection{struct vrna\+\_\+dimer\+\_\+pf\+\_\+s}
\subsubsection*{Data Fields}
\begin{DoxyCompactItemize}
\item 
\hypertarget{group__pf__cofold_a82e31d1fb6e95923fab6036f52c370af}{double \hyperlink{group__pf__cofold_a82e31d1fb6e95923fab6036f52c370af}{F0\+A\+B}}\label{group__pf__cofold_a82e31d1fb6e95923fab6036f52c370af}

\begin{DoxyCompactList}\small\item\em Null model without Duplex\+Init. \end{DoxyCompactList}\item 
\hypertarget{group__pf__cofold_a01a87f59db2b7fbf883b056e6f6c673a}{double \hyperlink{group__pf__cofold_a01a87f59db2b7fbf883b056e6f6c673a}{F\+A\+B}}\label{group__pf__cofold_a01a87f59db2b7fbf883b056e6f6c673a}

\begin{DoxyCompactList}\small\item\em all states with Duplex\+Init correction \end{DoxyCompactList}\item 
\hypertarget{group__pf__cofold_a7b01cea5721f61badebc29cf0a9c4266}{double \hyperlink{group__pf__cofold_a7b01cea5721f61badebc29cf0a9c4266}{Fc\+A\+B}}\label{group__pf__cofold_a7b01cea5721f61badebc29cf0a9c4266}

\begin{DoxyCompactList}\small\item\em true hybrid states only \end{DoxyCompactList}\item 
\hypertarget{group__pf__cofold_a1aca57247f2c023d08028b1919005b0a}{double \hyperlink{group__pf__cofold_a1aca57247f2c023d08028b1919005b0a}{F\+A}}\label{group__pf__cofold_a1aca57247f2c023d08028b1919005b0a}

\begin{DoxyCompactList}\small\item\em monomer A \end{DoxyCompactList}\item 
\hypertarget{group__pf__cofold_ab4d307be5400604d3c1d84d58a9981df}{double \hyperlink{group__pf__cofold_ab4d307be5400604d3c1d84d58a9981df}{F\+B}}\label{group__pf__cofold_ab4d307be5400604d3c1d84d58a9981df}

\begin{DoxyCompactList}\small\item\em monomer B \end{DoxyCompactList}\end{DoxyCompactItemize}
\index{vrna\+\_\+dimer\+\_\+conc\+\_\+s@{vrna\+\_\+dimer\+\_\+conc\+\_\+s}}\label{structvrna__dimer__conc__s}
\hypertarget{group__pf__cofold_structvrna__dimer__conc__s}{}
\subsubsection{struct vrna\+\_\+dimer\+\_\+conc\+\_\+s}
\subsubsection*{Data Fields}
\begin{DoxyCompactItemize}
\item 
\hypertarget{group__pf__cofold_a9722115f1a483583beaf7ef0f8180087}{double \hyperlink{group__pf__cofold_a9722115f1a483583beaf7ef0f8180087}{A0}}\label{group__pf__cofold_a9722115f1a483583beaf7ef0f8180087}

\begin{DoxyCompactList}\small\item\em start concentration A \end{DoxyCompactList}\item 
\hypertarget{group__pf__cofold_a5231715f610413dd5a88bc9f958cf5f3}{double \hyperlink{group__pf__cofold_a5231715f610413dd5a88bc9f958cf5f3}{B0}}\label{group__pf__cofold_a5231715f610413dd5a88bc9f958cf5f3}

\begin{DoxyCompactList}\small\item\em start concentration B \end{DoxyCompactList}\item 
\hypertarget{group__pf__cofold_aef56a1fe8d7f07e7b5d9a65417dda8a4}{double \hyperlink{group__pf__cofold_aef56a1fe8d7f07e7b5d9a65417dda8a4}{A\+Bc}}\label{group__pf__cofold_aef56a1fe8d7f07e7b5d9a65417dda8a4}

\begin{DoxyCompactList}\small\item\em End concentration A\+B. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{group__pf__cofold_ga4e5c7d06c302a7c59fc0d64dc142ca63}{\index{Partition Function for two hybridized Sequences@{Partition Function for two hybridized Sequences}!vrna\+\_\+pf\+\_\+dimer@{vrna\+\_\+pf\+\_\+dimer}}
\index{vrna\+\_\+pf\+\_\+dimer@{vrna\+\_\+pf\+\_\+dimer}!Partition Function for two hybridized Sequences@{Partition Function for two hybridized Sequences}}
\subsubsection[{vrna\+\_\+pf\+\_\+dimer}]{\setlength{\rightskip}{0pt plus 5cm}{\bf vrna\+\_\+dimer\+\_\+pf\+\_\+t} vrna\+\_\+pf\+\_\+dimer (
\begin{DoxyParamCaption}
\item[{{\bf vrna\+\_\+fold\+\_\+compound\+\_\+t} $\ast$}]{vc, }
\item[{char $\ast$}]{structure}
\end{DoxyParamCaption}
)}}\label{group__pf__cofold_ga4e5c7d06c302a7c59fc0d64dc142ca63}


{\ttfamily \#include $<$\hyperlink{part__func__co_8h}{Vienna\+R\+N\+A/part\+\_\+func\+\_\+co.\+h}$>$}



Calculate partition function and base pair probabilities of nucleic acid/nucleic acid dimers. 

This is the cofold partition function folding.

\begin{DoxySeeAlso}{See also}
\hyperlink{group__fold__compound_ga6601d994ba32b11511b36f68b08403be}{vrna\+\_\+fold\+\_\+compound()} for how to retrieve the necessary data structure
\end{DoxySeeAlso}

\begin{DoxyParams}{Parameters}
{\em vc} & the fold compound data structure \\
\hline
{\em structure} & Will hold the structure or constraints \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
vrna\+\_\+dimer\+\_\+pf\+\_\+t structure containing a set of energies needed for concentration computations. 
\end{DoxyReturn}
\hypertarget{group__pf__cofold_gaf04708a63d2385d5959db9f886741479}{\index{Partition Function for two hybridized Sequences@{Partition Function for two hybridized Sequences}!vrna\+\_\+pf\+\_\+dimer\+\_\+probs@{vrna\+\_\+pf\+\_\+dimer\+\_\+probs}}
\index{vrna\+\_\+pf\+\_\+dimer\+\_\+probs@{vrna\+\_\+pf\+\_\+dimer\+\_\+probs}!Partition Function for two hybridized Sequences@{Partition Function for two hybridized Sequences}}
\subsubsection[{vrna\+\_\+pf\+\_\+dimer\+\_\+probs}]{\setlength{\rightskip}{0pt plus 5cm}void vrna\+\_\+pf\+\_\+dimer\+\_\+probs (
\begin{DoxyParamCaption}
\item[{double}]{F\+A\+B, }
\item[{double}]{F\+A, }
\item[{double}]{F\+B, }
\item[{{\bf vrna\+\_\+plist\+\_\+t} $\ast$}]{pr\+A\+B, }
\item[{const {\bf vrna\+\_\+plist\+\_\+t} $\ast$}]{pr\+A, }
\item[{const {\bf vrna\+\_\+plist\+\_\+t} $\ast$}]{pr\+B, }
\item[{int}]{Alength, }
\item[{const {\bf vrna\+\_\+exp\+\_\+param\+\_\+t} $\ast$}]{exp\+\_\+params}
\end{DoxyParamCaption}
)}}\label{group__pf__cofold_gaf04708a63d2385d5959db9f886741479}


{\ttfamily \#include $<$\hyperlink{part__func__co_8h}{Vienna\+R\+N\+A/part\+\_\+func\+\_\+co.\+h}$>$}



Compute Boltzmann probabilities of dimerization without homodimers. 

Given the pair probabilities and free energies (in the null model) for a dimer A\+B and the two constituent monomers A and B, compute the conditional pair probabilities given that a dimer A\+B actually forms. Null model pair probabilities are given as a list as produced by \hyperlink{group__pf__fold_gaa3bf26a0ee2e9f2225afbaee44a37264}{vrna\+\_\+plist\+\_\+from\+\_\+probs()}, the dimer probabilities 'pr\+A\+B' are modified in place.


\begin{DoxyParams}{Parameters}
{\em F\+A\+B} & free energy of dimer A\+B \\
\hline
{\em F\+E\+A} & free energy of monomer A \\
\hline
{\em F\+E\+B} & free energy of monomer B \\
\hline
{\em pr\+A\+B} & pair probabilities for dimer \\
\hline
{\em pr\+A} & pair probabilities monomer \\
\hline
{\em pr\+B} & pair probabilities monomer \\
\hline
{\em Alength} & Length of molecule A \\
\hline
{\em exp\+\_\+params} & The precomputed Boltzmann factors \\
\hline
\end{DoxyParams}
\hypertarget{group__pf__cofold_ga83b8d5d0f7875d6d5013b208f23e3356}{\index{Partition Function for two hybridized Sequences@{Partition Function for two hybridized Sequences}!vrna\+\_\+pf\+\_\+dimer\+\_\+concentrations@{vrna\+\_\+pf\+\_\+dimer\+\_\+concentrations}}
\index{vrna\+\_\+pf\+\_\+dimer\+\_\+concentrations@{vrna\+\_\+pf\+\_\+dimer\+\_\+concentrations}!Partition Function for two hybridized Sequences@{Partition Function for two hybridized Sequences}}
\subsubsection[{vrna\+\_\+pf\+\_\+dimer\+\_\+concentrations}]{\setlength{\rightskip}{0pt plus 5cm}{\bf vrna\+\_\+dimer\+\_\+conc\+\_\+t}$\ast$ vrna\+\_\+pf\+\_\+dimer\+\_\+concentrations (
\begin{DoxyParamCaption}
\item[{double}]{Fc\+A\+B, }
\item[{double}]{Fc\+A\+A, }
\item[{double}]{Fc\+B\+B, }
\item[{double}]{F\+E\+A, }
\item[{double}]{F\+E\+B, }
\item[{const double $\ast$}]{startconc, }
\item[{const {\bf vrna\+\_\+exp\+\_\+param\+\_\+t} $\ast$}]{exp\+\_\+params}
\end{DoxyParamCaption}
)}}\label{group__pf__cofold_ga83b8d5d0f7875d6d5013b208f23e3356}


{\ttfamily \#include $<$\hyperlink{part__func__co_8h}{Vienna\+R\+N\+A/part\+\_\+func\+\_\+co.\+h}$>$}



Given two start monomer concentrations a and b, compute the concentrations in thermodynamic equilibrium of all dimers and the monomers. 

This function takes an array 'startconc' of input concentrations with alternating entries for the initial concentrations of molecules A and B (terminated by two zeroes), then computes the resulting equilibrium concentrations from the free energies for the dimers. Dimer free energies should be the dimer-\/only free energies, i.\+e. the Fc\+A\+B entries from the \hyperlink{group__pf__cofold_ga444df1587c9a2ca15b8eb25188f629c3}{vrna\+\_\+dimer\+\_\+pf\+\_\+t} struct.


\begin{DoxyParams}{Parameters}
{\em F\+E\+A\+B} & Free energy of A\+B dimer (Fc\+A\+B entry) \\
\hline
{\em F\+E\+A\+A} & Free energy of A\+A dimer (Fc\+A\+B entry) \\
\hline
{\em F\+E\+B\+B} & Free energy of B\+B dimer (Fc\+A\+B entry) \\
\hline
{\em F\+E\+A} & Free energy of monomer A \\
\hline
{\em F\+E\+B} & Free energy of monomer B \\
\hline
{\em startconc} & List of start concentrations \mbox{[}a0\mbox{]},\mbox{[}b0\mbox{]},\mbox{[}a1\mbox{]},\mbox{[}b1\mbox{]},...,\mbox{[}an\mbox{]}\mbox{[}bn\mbox{]},\mbox{[}0\mbox{]},\mbox{[}0\mbox{]} \\
\hline
{\em exp\+\_\+params} & The precomputed Boltzmann factors \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
vrna\+\_\+dimer\+\_\+conc\+\_\+t array containing the equilibrium energies and start concentrations 
\end{DoxyReturn}
